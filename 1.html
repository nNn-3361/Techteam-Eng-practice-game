<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Meeting RPG: Hardcore Mode</title>
    <style>
        :root {
            --bg-color: #0d1117; 
            --text-color: #c9d1d9;
            --accent-color: #58a6ff;
            --success-color: #238636;
            --error-color: #da3633;
            --warning-color: #d29922;
            --panel-bg: #161b22;
            --btn-bg: #21262d;
            --border-color: #30363d;
            --font-mono: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            --font-main: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-main);
            margin: 0; padding: 0;
            display: flex; flex-direction: column;
            min-height: 100vh;
        }

        #game-container {
            width: 100%; max-width: 600px; margin: 0 auto;
            background-color: var(--panel-bg);
            flex-grow: 1; display: flex; flex-direction: column;
            position: relative;
        }

        /* Header */
        header {
            background-color: #010409;
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            position: sticky; top: 0; z-index: 5;
        }

        .header-top {
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;
        }

        .header-title { font-family: var(--font-mono); font-weight: bold; color: var(--accent-color); font-size: 0.9rem; }
        .score-badge { font-family: var(--font-mono); color: var(--success-color); font-weight: bold; }

        .progress-track {
            width: 100%; height: 6px; background-color: #30363d; border-radius: 3px; overflow: hidden;
        }
        .progress-bar {
            height: 100%; background-color: var(--accent-color); width: 0%;
            transition: width 0.3s ease;
        }

        /* Content */
        #scene-area {
            padding: 20px; flex-grow: 1; display: flex; flex-direction: column;
            padding-bottom: 40px; animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .difficulty-badge {
            display: inline-block; padding: 4px 8px; border-radius: 4px;
            font-size: 0.7rem; font-weight: bold; text-transform: uppercase;
            margin-bottom: 10px; font-family: var(--font-mono);
        }
        .diff-easy { background: rgba(59, 185, 80, 0.15); color: #3fb950; border: 1px solid #238636; }
        .diff-med { background: rgba(210, 153, 34, 0.15); color: #d29922; border: 1px solid #9e6a03; }
        .diff-hard { background: rgba(248, 81, 73, 0.15); color: #f85149; border: 1px solid #da3633; }

        .terminal-text { color: #8b949e; margin-bottom: 10px; font-size: 0.8rem; font-family: var(--font-mono); }

        .npc-dialogue {
            background-color: #21262d; border-left: 4px solid var(--accent-color);
            padding: 20px; margin-bottom: 25px; border-radius: 0 8px 8px 0;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .npc-name {
            font-size: 0.75rem; color: var(--accent-color); margin-bottom: 8px;
            text-transform: uppercase; letter-spacing: 1px; font-weight: bold;
        }
        .npc-text-content { font-size: 1.1rem; line-height: 1.5; font-weight: 500; }

        /* Options */
        .options-grid { display: grid; gap: 12px; margin-top: auto; }

        .option-btn {
            background-color: var(--btn-bg); border: 1px solid var(--border-color);
            color: var(--text-color); padding: 18px 15px;
            text-align: left; font-size: 0.95rem; cursor: pointer;
            border-radius: 8px; position: relative; overflow: hidden;
            display: flex; align-items: flex-start; transition: background 0.2s;
        }
        .option-btn:active { background-color: #30363d; transform: scale(0.99); }
        .option-tag {
            font-family: var(--font-mono); color: #666; margin-right: 12px;
            font-size: 0.9em; min-width: 15px; margin-top: 2px;
        }

        /* Feedback */
        #feedback-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.95); z-index: 100;
            justify-content: center; align-items: center; padding: 20px;
        }

        .feedback-box {
            background-color: var(--panel-bg); border: 1px solid var(--border-color);
            padding: 25px; width: 100%; max-width: 400px; border-radius: 12px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.7);
        }

        .feedback-header { font-size: 1.2rem; margin-bottom: 15px; font-weight: bold; font-family: var(--font-mono); }
        .feedback-header.success { color: #3fb950; }
        .feedback-header.warning { color: var(--warning-color); }
        .feedback-header.error { color: var(--error-color); }
        
        .feedback-analysis {
            font-size: 0.95rem; line-height: 1.6; color: #c9d1d9;
            margin-bottom: 25px; background: #0d1117; padding: 15px; border-radius: 6px; border: 1px solid #30363d;
        }

        .next-btn {
            width: 100%; background-color: var(--accent-color); color: #000;
            font-weight: bold; border: none; padding: 16px; font-size: 1rem;
            cursor: pointer; border-radius: 8px; font-family: var(--font-mono);
        }

        /* Screens */
        .screen {
            padding: 40px 20px; display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center; height: 100vh;
        }
        .start-btn {
            margin-top: 40px; padding: 18px 50px; font-size: 1.2rem;
            background-color: #238636; color: white; border: none;
            cursor: pointer; font-family: var(--font-mono); border-radius: 50px;
            box-shadow: 0 4px 20px rgba(35, 134, 54, 0.4);
        }
    </style>
</head>
<body>

    <div id="game-container">
        <header id="game-header" style="display:none;">
            <div class="header-top">
                <div class="header-title">PRAGMATIC_ENGINEER_SIM_V3</div>
                <div class="score-badge">SCORE: <span id="score-display">0</span></div>
            </div>
            <div class="progress-track">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
        </header>

        <div id="start-screen" class="screen">
            <h1 style="color:var(--accent-color); font-size:2rem; margin-bottom:10px;">&lt;Meeting RPG /&gt;</h1>
            <h2 style="color:#8b949e; font-size:1rem; font-weight:normal; margin-top:0;">Version 3.0: Full Stack Comms</h2>
            <p style="color:#8b949e; margin-top:30px; line-height:1.6; max-width:300px;">
                let's improve our English together!<br>
                Are you ready?<br>
                Challenge the 10 random scenarios.
            </p>
            <button class="start-btn" onclick="initGame()">Start Simulation</button>
        </div>

        <div id="scene-area" style="display:none;">
            <div id="badge-area"></div>
            <div class="terminal-text" id="scene-context"></div>
            
            <div class="npc-dialogue">
                <div class="npc-name" id="npc-name"></div>
                <div class="npc-text-content" id="npc-text"></div>
            </div>

            <div class="options-grid" id="options-container"></div>
        </div>

        <div id="end-screen" class="screen" style="display:none;">
            <h1 id="final-title">Simulation End</h1>
            <p style="color:#8b949e;">Performance Review</p>
            <p style="font-size: 3.5rem; color: var(--accent-color); margin: 10px 0; font-family: var(--font-mono);" id="final-score">0</p>
            <p id="final-msg" style="margin-top:20px; color:#c9d1d9; line-height: 1.6; padding: 0 20px; max-width:400px;"></p>
            <button class="next-btn" onclick="location.reload()" style="margin-top:30px;">New Random Set</button>
        </div>

        <div id="feedback-overlay">
            <div class="feedback-box">
                <div id="feedback-header" class="feedback-header"></div>
                <div id="feedback-content" class="feedback-analysis"></div>
                <button class="next-btn" onclick="nextLevel()">Next Level >></button>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        //  DATABASE: 30 Scenarios
        // ==========================================
        const scenarioPool = [
            // ==========================================================
            // LEVEL 1-3: JUNIOR (Basic Politeness, Clarity, Reporting)
            // ==========================================================
            {
                difficulty: 1, npc: "Senior_Dev", context: "Code Review: Naming conventions.",
                text: "Please rename 'x' to 'userTimestamp'. 'x' is meaningless.",
                options: [
                    { text: "Fine. I will change it.", type: "passive", analysis: "âš ï¸ <b>Too Passive</b><br>é›–ç„¶è½è©±ï¼Œä½†å–®å­— 'Fine' å¸¶æœ‰ä¸æƒ…é¡˜çš„æ„æ¶µï¼Œå®¹æ˜“è¢«èª¤è§£ã€‚" },
                    { text: "Whatever, it's just a variable name.", type: "aggressive", analysis: "ğŸš« <b>Aggressive</b><br>å° Code Quality å±•ç¾ä¸å±‘ï¼Œæœƒè¢«æ¨™è¨˜ç‚º 'Uncoachable'ã€‚" },
                    { text: "Good catch. I'll update it to be more descriptive.", type: "pragmatic", analysis: "âœ… <b>Constructive</b><br>æ­£é¢æ¥å—å›é¥‹ ('Good catch') ä¸¦å±•ç¾æ”¹é€²æ„é¡˜ã€‚" }
                ]
            },
            {
                difficulty: 1, npc: "Colleague", context: "Borrowing: You need a test device.",
                text: "Hey, are you using the Android test phone?",
                options: [
                    { text: "Give me the phone. I need it.", type: "aggressive", analysis: "ğŸš« <b>Imperative</b><br>å‘½ä»¤å¥åœ¨è«‹æ±‚å”åŠ©æ™‚éå¸¸å¤±ç¦®ã€‚" },
                    { text: "I was wondering if I could borrow the phone for an hour?", type: "pragmatic", analysis: "âœ… <b>Polite Request</b><br>'I was wondering if...' æ˜¯æ¨™æº–ä¸”å¾—é«”çš„è«‹æ±‚å¥å‹ã€‚" },
                    { text: "I want the phone.", type: "passive", analysis: "âš ï¸ <b>Childish</b><br>'I want' è½èµ·ä¾†åƒå°å­©ï¼Œç¼ºä¹è·å ´å°ˆæ¥­åº¦ã€‚" }
                ]
            },
            {
                difficulty: 1, npc: "HR_Manager", context: "Scheduling: Mandatory training conflict.",
                text: "Can you attend the security training at 2 PM?",
                options: [
                    { text: "No, I'm busy.", type: "aggressive", analysis: "ğŸš« <b>Too Blunt</b><br>ç›´æ¥æ‹’çµ•ä¸”ç„¡ç†ç”±ï¼Œé¡¯å¾—ä¸åˆç¾¤ã€‚" },
                    { text: "I'd love to, but I have a deployment at 2 PM. Is there another slot?", type: "pragmatic", analysis: "âœ… <b>Soft Refusal</b><br>æ„é¡˜ (I'd love to) + ç†ç”± (but...) + æ›¿ä»£æ–¹æ¡ˆ (Is there...?)ã€‚" },
                    { text: "Okay.", type: "passive", analysis: "âš ï¸ <b>Risky</b><br>å¦‚æœä½ çœŸçš„æœ‰äº‹å»ç­”æ‡‰ï¼Œç¼ºå¸­æœƒæ¯”æ‹’çµ•æ›´åš´é‡ã€‚" }
                ]
            },
            {
                difficulty: 1, npc: "Team_Lead", context: "Status Update: You are slightly behind.",
                text: "Is the API integration done yet?",
                options: [
                    { text: "Not yet.", type: "passive", analysis: "âš ï¸ <b>Incomplete</b><br>è®“ä¸»ç®¡è¦ºå¾—ä½ ç„¡æ³•æŒæ§é€²åº¦ã€‚" },
                    { text: "Almost. Just fixing one edge case, should be done by 4 PM.", type: "pragmatic", analysis: "âœ… <b>Reassuring</b><br>æä¾›ç‹€æ…‹ (Almost) + é˜»ç¤™ (edge case) + é è¨ˆæ™‚é–“ (4 PM)ã€‚" },
                    { text: "Why do you keep asking?", type: "aggressive", analysis: "ğŸš« <b>Defensive</b><br>åæ“Šä¸»ç®¡çš„é—œå¿ƒï¼Œæœƒé€ æˆä¿¡ä»»å±æ©Ÿã€‚" }
                ]
            },
            {
                difficulty: 1, npc: "QA_Tester", context: "Bug Report: QA found a bug you think is a feature.",
                text: "The user can't click 'Next' without filling the form. It's a bug.",
                options: [
                    { text: "That's not a bug, it's a feature. Read the spec.", type: "aggressive", analysis: "ğŸš« <b>Arrogant</b><br>å«åˆ¥äºº 'å»è®€ Spec' æ˜¯å·¥ç¨‹å¸«æœ€è¨äººå­çš„èªªè©±æ–¹å¼ä¹‹ä¸€ã€‚" },
                    { text: "Oh, really? I didn't know that.", type: "passive", analysis: "âš ï¸ <b>Clueless</b><br>å¦‚æœä½ æ˜¯é–‹ç™¼è€…ï¼Œä½ ä¸æ‡‰è©²è¡¨ç¾å¾—å°è‡ªå·±çš„åŠŸèƒ½ä¸€ç„¡æ‰€çŸ¥ã€‚" },
                    { text: "Actually, that's intended behavior to prevent incomplete data. But maybe the error message could be clearer?", type: "pragmatic", analysis: "âœ… <b>Collaborative</b><br>è§£é‡‹åŸå›  (Intended behavior) ä¸¦æå‡ºæ”¹å–„ UI çš„å»ºè­° (Clearer message)ã€‚" }
                ]
            },
            {
                difficulty: 1, npc: "Colleague", context: "Lunch: You want to invite a new hire.",
                text: "(New hire looks lonely)",
                options: [
                    { text: "You coming to eat?", type: "aggressive", analysis: "âš ï¸ <b>Too Casual</b><br>æœ‰é»å¤ªéš¨ä¾¿ï¼Œå°ä¸ç†Ÿçš„äººå¯èƒ½ç¨é¡¯å”çªã€‚" },
                    { text: "Hey, a few of us are grabbing lunch at the noodle place. Would you like to join us?", type: "pragmatic", analysis: "âœ… <b>Welcoming</b><br>æ˜ç¢ºçš„è³‡è¨Š (Where) + ç¦®è²Œçš„é‚€è«‹ (Would you like to)ã€‚" },
                    { text: "...", type: "passive", analysis: "ğŸš« <b>Cold</b><br>ç„¡è¦–æ–°äººæœƒè®“åœ˜éšŠæ°£æ°›è®Šåƒµã€‚" }
                ]
            },
            {
                difficulty: 1, npc: "IT_Support", context: "Wi-Fi Issue: Internet is slow.",
                text: "Did you try restarting your computer?",
                options: [
                    { text: "Of course I did. I'm an engineer, not an idiot.", type: "aggressive", analysis: "ğŸš« <b>Rude</b><br>IT åªæ˜¯ç…§æµç¨‹è©¢å•ï¼Œä¸éœ€è¦å±•ç¾å„ªè¶Šæ„Ÿã€‚" },
                    { text: "Yes, I've tried that and also flushed the DNS, but it's still slow.", type: "pragmatic", analysis: "âœ… <b>Professional</b><br>å¹³éœåœ°èªªæ˜ä½ å·²å˜—è©¦éçš„æ­¥é©Ÿï¼Œå”åŠ© IT å¿«é€Ÿæ’é™¤å•é¡Œã€‚" },
                    { text: "I don't know what to do.", type: "passive", analysis: "âš ï¸ <b>Helpless</b><br>èº«ç‚ºå·¥ç¨‹å¸«ï¼Œå¯ä»¥å±•ç¾å¤šä¸€é»åŸºæœ¬çš„ Debug èƒ½åŠ›ã€‚" }
                ]
            },
            {
                difficulty: 1, npc: "Manager", context: "Leaving Early: You have a dentist appointment.",
                text: "Hey, can we talk about the project?",
                options: [
                    { text: "I'm leaving now. Bye.", type: "aggressive", analysis: "ğŸš« <b>Unprofessional</b><br>æ²’æœ‰è§£é‡‹åŸå› ç›´æ¥èµ°äººï¼Œéå¸¸ä¸è² è²¬ä»»ã€‚" },
                    { text: "I have a dentist appointment at 5, so I need to head out. Can we catch up tomorrow morning?", type: "pragmatic", analysis: "âœ… <b>Clear Boundaries</b><br>èªªæ˜åŸå›  + æå‡ºè£œå„Ÿæ™‚é–“ (Tomorrow morning)ã€‚" },
                    { text: "Um, okay...", type: "passive", analysis: "âš ï¸ <b>Doormat</b><br>ä¸æ•¢èªªè‡ªå·±è¦èµ°ï¼Œçµæœå°è‡´é²åˆ°æˆ–æœƒè­°å¿ƒä¸åœ¨ç„‰ã€‚" }
                ]
            },
            {
                difficulty: 1, npc: "Peer", context: "Help Request: Colleague asks for code help.",
                text: "Can you help me debug this? I'm stuck.",
                options: [
                    { text: "Google it.", type: "aggressive", analysis: "ğŸš« <b>Dismissive</b><br>é›–ç„¶ Google æ˜¯å°çš„ï¼Œä½†åœ¨åœ˜éšŠä¸­é€™æ¨£èªªéå¸¸å†·æ¼ ã€‚" },
                    { text: "I'm a bit swamped right now, but if you send me the error log, I can take a look in 30 mins.", type: "pragmatic", analysis: "âœ… <b>Helpful boundaries</b><br>è¨­å®šç•Œç·š (Swamped) ä½†ä¸æ‹’çµ•å”åŠ© (Look in 30 mins)ã€‚" },
                    { text: "Sure! (Spends 2 hours helping)", type: "passive", analysis: "âš ï¸ <b>Time Management Risk</b><br>æ²’æœ‰è©•ä¼°è‡ªå·±æ™‚é–“å°±å…¨ç›¤æ¥å—ï¼Œæœƒå®³æ­»è‡ªå·±çš„é€²åº¦ã€‚" }
                ]
            },
            {
                difficulty: 1, npc: "Scrum_Master", context: "Stand-up Meeting: You forgot what you did yesterday.",
                text: "What did you work on yesterday?",
                options: [
                    { text: "I don't remember. Stuff.", type: "aggressive", analysis: "ğŸš« <b>Unprepared</b><br>é€™é¡¯ç¤ºä½ å°å·¥ä½œç¼ºä¹åœ¨ä¹ã€‚" },
                    { text: "Mostly bug fixing. I'll check my commits.", type: "passive", analysis: "âš ï¸ <b>Vague</b><br>Daily Stand-up éœ€è¦å…·é«”è³‡è¨Šï¼Œè€Œéæ¨¡ç³Šå¸¶éã€‚" },
                    { text: "I worked on the login module refactoring. I cleared 3 tickets, and today I'll focus on unit tests.", type: "pragmatic", analysis: "âœ… <b>Precise</b><br>å…·é«”çš„ä»»å‹™ (Refactoring) + é€²åº¦ (3 tickets) + ä»Šæ—¥è¨ˆç•«ã€‚" }
                ]
            },

            // ==========================================================
            // LEVEL 4-7: SENIOR (Negotiation, Trade-offs, Pushback)
            // ==========================================================
            {
                difficulty: 2, npc: "Project_Manager", context: "Scope Creep: Feature request on Friday.",
                text: "Client wants this button blue. Can you change it quickly?",
                options: [
                    { text: "No. Spec is locked.", type: "aggressive", analysis: "ğŸš« <b>Too Rigid</b><br>å¤ªåƒµåŒ–ï¼Œæ²’æœ‰è§£æ±º PM é¢å°å®¢æˆ¶çš„å£“åŠ›ã€‚" },
                    { text: "I see. Changing it implies updating tests and screenshots. It might delay the release. Do we prioritize this?", type: "pragmatic", analysis: "âœ… <b>Impact Analysis</b><br>ä¸èªª Noï¼Œè€Œæ˜¯èªªæ˜æˆæœ¬ (Tests/Screenshots) ä¸¦å°‡æ±ºå®šæ¬Šäº¤é‚„çµ¦ PMã€‚" },
                    { text: "Okay, I'll try.", type: "passive", analysis: "âš ï¸ <b>Hidden Risk</b><br>é€™æœƒè®“ä½ æ‰¿æ“”æœªçŸ¥çš„é¢¨éšªï¼Œä¸”åŠ©é•·éš¨æ„æ”¹éœ€æ±‚çš„é¢¨æ°£ã€‚" }
                ]
            },
            {
                difficulty: 2, npc: "Marketing_Head", context: "Tech Limitation: Explaining AI.",
                text: "Why can't we use AI to generate all content instantly?",
                options: [
                    { text: "That's stupid. AI hallucinates.", type: "aggressive", analysis: "ğŸš« <b>Insulting</b><br>ç›´æ¥å¦å®šå°æ–¹çš„æƒ³æ³•ï¼Œæœƒé€ æˆéƒ¨é–€å°ç«‹ã€‚" },
                    { text: "Current LLMs have reliability risks. We might publish false info. A hybrid approach involves human review is safer.", type: "pragmatic", analysis: "âœ… <b>Risk Management</b><br>å°ˆæ³¨æ–¼é¢¨éšª (Reliability) ä¸¦æå‡ºæ›¿ä»£æ–¹æ¡ˆ (Hybrid)ã€‚" },
                    { text: "It's too technical to explain.", type: "aggressive", analysis: "ğŸš« <b>Condescending</b><br>å‚²æ…¢ï¼Œçœ‹ä¸èµ·éæŠ€è¡“äººå“¡ã€‚" }
                ]
            },
            {
                difficulty: 2, npc: "Junior_Dev", context: "Mentoring: Junior broke the build.",
                text: "I'm so sorry! I crashed the server.",
                options: [
                    { text: "Be more careful next time.", type: "aggressive", analysis: "ğŸš« <b>Useless Scolding</b><br>å–®ç´”è²¬ç½µæ²’æœ‰æ•™è‚²æ„ç¾©ã€‚" },
                    { text: "Don't worry, it happens. Let's look at the logs together to see how we can prevent this.", type: "pragmatic", analysis: "âœ… <b>Mentorship</b><br>å°‡éŒ¯èª¤è½‰åŒ–ç‚ºå­¸ç¿’æ©Ÿæœƒ (Prevent this)ã€‚" },
                    { text: "I'll fix it for you.", type: "passive", analysis: "âš ï¸ <b>Enabling</b><br>å¹«ä»–åšï¼Œä»–å°±æ°¸é å­¸ä¸æœƒæ€éº¼ä¿®ã€‚" }
                ]
            },
            {
                difficulty: 2, npc: "Product_Owner", context: "Estimation: Impossible deadline.",
                text: "Can you promise this goes live Monday?",
                options: [
                    { text: "I promise.", type: "passive", analysis: "âš ï¸ <b>The Trap</b><br>è»Ÿé«”é–‹ç™¼å……æ»¿è®Šæ•¸ï¼Œçµ•å°ä¸è¦è¼•æ˜“èªª Promiseã€‚" },
                    { text: "Our target is Monday. However, if QA finds critical bugs, we will need a buffer. I'll keep you updated daily.", type: "pragmatic", analysis: "âœ… <b>Managing Expectations</b><br>çµ¦å‡ºç›®æ¨™ (Target) ä½†ä¿ç•™ç·©è¡ (Buffer) ä¸¦æ‰¿è«¾æºé€š (Update daily)ã€‚" },
                    { text: "No way.", type: "aggressive", analysis: "ğŸš« <b>Unhelpful</b><br>è½èµ·ä¾†åƒåœ¨æ¨å¸è²¬ä»»ã€‚" }
                ]
            },
            {
                difficulty: 2, npc: "Designer", context: "Design Handoff: Impossible UI animation.",
                text: "I want this menu to explode into particles when clicked.",
                options: [
                    { text: "That's impossible in web browsers.", type: "aggressive", analysis: "ğŸš« <b>Lazy</b><br>é€™é€šå¸¸ä¸æ˜¯çœŸçš„ä¸å¯èƒ½ï¼Œåªæ˜¯ä½ ä¸æƒ³åšæˆ–å¤ªé›£åšã€‚" },
                    { text: "That looks cool, but it will heavily impact performance on mobile. Can we do a simple fade-out instead?", type: "pragmatic", analysis: "âœ… <b>Alternative</b><br>å…ˆè‚¯å®š (Looks cool) -> æå‡ºä»£åƒ¹ (Performance) -> æå‡ºæ›¿ä»£æ¡ˆ (Fade-out)ã€‚" },
                    { text: "Ok, I will try to implement a particle engine.", type: "passive", analysis: "âš ï¸ <b>Over-engineering</b><br>ç‚ºäº†å°ç‰¹æ•ˆèŠ±è²»æ•¸é€±é–‹ç™¼ï¼Œä¸ç¬¦åˆå•†æ¥­æ•ˆç›Šã€‚" }
                ]
            },
            {
                difficulty: 2, npc: "Manager", context: "Meeting Overload: Too many meetings.",
                text: "I'm adding a daily sync at 4 PM.",
                options: [
                    { text: "Another meeting? I can't work like this.", type: "aggressive", analysis: "ğŸš« <b>Complaining</b><br>é›–ç„¶ä½ æ˜¯å°çš„ï¼Œä½†æŠ±æ€¨ç„¡åŠ©æ–¼è§£æ±ºå•é¡Œã€‚" },
                    { text: "We already have a morning stand-up. I'm concerned a 4 PM sync will interrupt deep work flow. Can we try async updates on Slack?", type: "pragmatic", analysis: "âœ… <b>Productivity Focus</b><br>ç”¨ã€Œå·¥ä½œæ•ˆç‡ (Deep work)ã€ä½œç‚ºæ‹’çµ•çš„ç†ç”±ï¼Œè€é—†æ‰è½å¾—é€²å»ã€‚" },
                    { text: "Okay, I'll be there.", type: "passive", analysis: "âš ï¸ <b>Productivity Killer</b><br>é»˜é»˜æ¥å—ç„¡æ•ˆæœƒè­°ï¼Œæœ€å¾Œå—è‹¦çš„æ˜¯ä½ çš„ç”¢å‡ºã€‚" }
                ]
            },
            {
                difficulty: 2, npc: "Sales_Team", context: "Documentation: Sales needs technical docs.",
                text: "Can you write a user manual for us by tomorrow?",
                options: [
                    { text: "I'm a developer, not a writer.", type: "aggressive", analysis: "ğŸš« <b>Not my job</b><br>åŠƒåˆ†ç•Œç·šå¤ªç”Ÿç¡¬ã€‚" },
                    { text: "I can provide the bullet points of features, but I don't have bandwidth for a full manual. Can marketing flesh it out?", type: "pragmatic", analysis: "âœ… <b>Delegation</b><br>æä¾›å”åŠ© (Bullet points) ä½†é‡æ¸…è²¬ä»»æ­¸å±¬ (Can marketing...?)ã€‚" },
                    { text: "Sure, I'll write it.", type: "passive", analysis: "âš ï¸ <b>Misuse of Talent</b><br>å·¥ç¨‹å¸«æ™‚è–ªå¾ˆé«˜ï¼Œæ‹¿ä¾†å¯«æ‰‹å†Šæ˜¯è³‡æºæµªè²»ã€‚" }
                ]
            },
            {
                difficulty: 2, npc: "Client", context: "Requirement Change: Client contradicts themselves.",
                text: "I know I said 'Simple', but I actually meant 'Advanced'.",
                options: [
                    { text: "You said simple. We built simple. You pay for simple.", type: "aggressive", analysis: "ğŸš« <b>Hostile</b><br>è·Ÿå®¢æˆ¶åµæ¶æ˜¯çµ•å°ç¦å¿Œã€‚" },
                    { text: "Understood. Switching to 'Advanced' is a significant change request. Let's scope this out and see how it affects the budget.", type: "pragmatic", analysis: "âœ… <b>Business Logic</b><br>å°‡éœ€æ±‚è®Šæ›´è½‰åŒ–ç‚ºã€Œåˆç´„/é ç®— (Budget)ã€å•é¡Œï¼Œè®“å®¢æˆ¶è‡ªå·±è¡¡é‡ã€‚" },
                    { text: "Okay, we will change it.", type: "passive", analysis: "âš ï¸ <b>Scope Creep</b><br>å…è²»å¹«å®¢æˆ¶å‡ç´šï¼Œå…¬å¸æœƒè™§éŒ¢ã€‚" }
                ]
            },
            {
                difficulty: 2, npc: "Backend_Team", context: "Dependency: API is delayed.",
                text: "The API won't be ready until next week.",
                options: [
                    { text: "Then I can't do my job.", type: "aggressive", analysis: "ğŸš« <b>Blaming</b><br>é›™æ‰‹ä¸€æ”¤ï¼Œé¡¯å¾—ä½ æ²’æœ‰è§£æ±ºå•é¡Œçš„èƒ½åŠ›ã€‚" },
                    { text: "Okay, I'll mock the data for now so I can continue frontend work. Please let me know the final JSON structure.", type: "pragmatic", analysis: "âœ… <b>Unblocking</b><br>ä¸»å‹•å°‹æ‰¾è§£æ³• (Mock data) è®“è‡ªå·±ä¸å—é˜»ç¤™ã€‚" },
                    { text: "Okay, I'll wait.", type: "passive", analysis: "âš ï¸ <b>Idle</b><br>ç©ºè½‰ä¸€é€±ï¼Œå°ˆæ¡ˆé€²åº¦æœƒåš´é‡è½å¾Œã€‚" }
                ]
            },
            {
                difficulty: 2, npc: "Recruiter", context: "Interviewing: Asking about salary expectations.",
                text: "What is your expected salary?",
                options: [
                    { text: "I want 100k.", type: "passive", analysis: "âš ï¸ <b>Anchoring low</b><br>å¤ªæ—©æ€åº•ç‰Œå¯èƒ½æœƒè®“ä½ å°‘æ‹¿å¾ˆå¤šã€‚" },
                    { text: "I'm looking for a competitive rate based on the responsibilities. What is the budget range for this role?", type: "pragmatic", analysis: "âœ… <b>Negotiation</b><br>åå• (What is the budget) æ˜¯è«‡è–ªæ°´çš„é»ƒé‡‘æ³•å‰‡ã€‚" },
                    { text: "That's private.", type: "aggressive", analysis: "ğŸš« <b>Weird</b><br>é¢è©¦å°±æ˜¯è¦è«‡é€™å€‹ï¼Œæ‹’çµ•å›ç­”å¾ˆå¥‡æ€ªã€‚" }
                ]
            },

            // ==========================================================
            // LEVEL 8-10: TECH LEAD/CTO (Crisis, Politics, Strategy)
            // ==========================================================
            {
                difficulty: 3, npc: "CEO", context: "Crisis: Site down during Black Friday.",
                text: "We are losing money! Why isn't it fixed?!",
                options: [
                    { text: "Stop yelling!", type: "aggressive", analysis: "ğŸš« <b>Suicide</b><br>å«è€é—†é–‰å˜´æ„å‘³è‘—ä½ è¦å¤±æ¥­äº†ã€‚" },
                    { text: "We identified the bottleneck. Rolling back the update now. Service restores in 5 mins.", type: "pragmatic", analysis: "âœ… <b>Crisis Comms</b><br>ç™¼ç¾å•é¡Œ (Identified) -> è¡Œå‹• (Rolling back) -> çµæœ (5 mins)ã€‚å†·éœä¸”æ˜ç¢ºã€‚" },
                    { text: "The DB config was wrong due to a race condition.", type: "passive", analysis: "âš ï¸ <b>TMI</b><br>è€é—†ç¾åœ¨ä¸åœ¨ä¹æŠ€è¡“ç´°ç¯€ï¼Œåªåœ¨ä¹ä½•æ™‚ä¿®å¥½ã€‚" }
                ]
            },
            {
                difficulty: 3, npc: "VP_Eng", context: "Tech Stack: VP chooses bad tech for cost.",
                text: "We use Tech X because it's cheaper.",
                options: [
                    { text: "Tech X is garbage.", type: "aggressive", analysis: "ğŸš« <b>Unprofessional</b><br>æƒ…ç·’åŒ–ç™¼è¨€ã€‚" },
                    { text: "Tech X saves upfront cost but has high long-term maintenance. Here is a TCO (Total Cost of Ownership) comparison.", type: "pragmatic", analysis: "âœ… <b>Data Driven</b><br>ç”¨æ•¸æ“š (TCO) è­‰æ˜ä¾¿å®œçš„æ±è¥¿å…¶å¯¦æ›´è²´ã€‚" },
                    { text: "Yes sir.", type: "passive", analysis: "âš ï¸ <b>Yes Man</b><br>ç›²ç›®é †å¾æœƒå°è‡´æŠ€è¡“å‚µç´¯ç©ï¼Œæœ€å¾Œé‚„æ˜¯ä½ è¦ä¿®ã€‚" }
                ]
            },
            {
                difficulty: 3, npc: "Big_Client", context: "Security: Critical bug found before launch.",
                text: "Launch tomorrow! You can't delay us!",
                options: [
                    { text: "Security first.", type: "aggressive", analysis: "ğŸš« <b>Too Cold</b><br>å¿½ç•¥äº†å®¢æˆ¶çš„ç„¦æ…®ã€‚" },
                    { text: "I know it's frustrating. But this bug risks exposing user data. Delaying 2 days is better than a lawsuit.", type: "pragmatic", analysis: "âœ… <b>Reframing</b><br>å°‡ã€Œå»¶é²ã€é‡æ–°åŒ…è£ç‚ºã€Œé¿å…è¨´è¨Ÿ (Lawsuit)ã€ï¼Œé€™æ˜¯ç‚ºäº†å®¢æˆ¶å¥½ã€‚" },
                    { text: "Sorry, we have a bug.", type: "passive", analysis: "âš ï¸ <b>Weak</b><br>å–®ç´”é“æ­‰ç„¡æ³•èªªæœå®¢æˆ¶å»¶æœŸã€‚" }
                ]
            },
            {
                difficulty: 3, npc: "CTO", context: "Resource: No budget for hiring.",
                text: "No new hires. Make do with current team.",
                options: [
                    { text: "Then project fails.", type: "aggressive", analysis: "ğŸš« <b>Threat</b><br>å¨è„…ä¸»ç®¡æ˜¯å¤§å¿Œã€‚" },
                    { text: "Understood. Then we must cut scope or extend timeline to maintain quality. Which do you prefer?", type: "pragmatic", analysis: "âœ… <b>Iron Triangle</b><br>è³‡æºå›ºå®šï¼Œé‚£å°±å¿…é ˆèª¿æ•´ç¯„åœ (Scope) æˆ–æ™‚é–“ (Time)ã€‚çµ¦è€é—†é¸ã€‚" },
                    { text: "We will work harder.", type: "passive", analysis: "âš ï¸ <b>Burnout</b><br>æ‰¿è«¾åšä¸åˆ°çš„äº‹ï¼Œæœƒå°è‡´åœ˜éšŠéå‹ã€‚" }
                ]
            },
            {
                difficulty: 3, npc: "Co-Founder", context: "Feature: Founder wants a useless feature.",
                text: "I want a chatbot that tells jokes on the homepage.",
                options: [
                    { text: "That distracts from the user journey. Let's A/B test it first to see if it actually converts.", type: "pragmatic", analysis: "âœ… <b>Data Proof</b><br>ä¸ç›´æ¥èªªä¸ï¼Œè€Œæ˜¯ç”¨æ•¸æ“š (A/B Test) ä¾†è®“çœŸç†èªªè©±ã€‚" },
                    { text: "That's a dumb idea.", type: "aggressive", analysis: "ğŸš« <b>Career limiting</b><br>ä¸è¦èªªå‰µè¾¦äººçš„é»å­è ¢ã€‚" },
                    { text: "Ok, building it now.", type: "passive", analysis: "âš ï¸ <b>Waste</b><br>æµªè²»é–‹ç™¼è³‡æºåœ¨ç„¡æ„ç¾©çš„åŠŸèƒ½ä¸Šã€‚" }
                ]
            },
            {
                difficulty: 3, npc: "Team_Member", context: "Performance: Engineer is underperforming.",
                text: "I'm trying my best, why a PIP (Performance Plan)?",
                options: [
                    { text: "You are just not good enough.", type: "aggressive", analysis: "ğŸš« <b>Cruel</b><br>æ‰“æ“Šä¿¡å¿ƒä¸”ç„¡æ³•å¾‹ä¿è­·ã€‚" },
                    { text: "This isn't about effort, it's about output. This plan gives you clear targets to get back on track. I want you to succeed.", type: "pragmatic", analysis: "âœ… <b>Objective</b><br>å°äº‹ä¸å°äºº (Output vs Effort)ï¼Œä¸¦è¨­å®šæ¸…æ™°ç›®æ¨™ã€‚" },
                    { text: "Maybe I can lower the expectations.", type: "passive", analysis: "âš ï¸ <b>Bad Management</b><br>é™ä½æ¨™æº–æœƒæ‹–ç´¯æ•´å€‹åœ˜éšŠã€‚" }
                ]
            },
            {
                difficulty: 3, npc: "Legal_Dept", context: "Compliance: Legal blocks your innovative feature.",
                text: "You can't do this. GDPR violation.",
                options: [
                    { text: "Legal always ruins everything.", type: "aggressive", analysis: "ğŸš« <b>Immature</b><br>æŠ±æ€¨è¦å‰‡åˆ¶å®šè€…ã€‚" },
                    { text: "I see. What if we anonymize the data before processing? Would that satisfy the compliance requirement?", type: "pragmatic", analysis: "âœ… <b>Problem Solving</b><br>å°‹æ±‚åˆè¦çš„æŠ€è¡“è§£æ±ºæ–¹æ¡ˆ (Anonymize)ã€‚" },
                    { text: "We'll do it anyway and hope nobody notices.", type: "aggressive", analysis: "ğŸš« <b>Illegal</b><br>çµ•å°ä¸è¦å»ºè­°é•æ³•è¡Œç‚ºã€‚" }
                ]
            },
            {
                difficulty: 3, npc: "Vendor", context: "Negotiation: Vendor raises price by 50%.",
                text: "Our licensing fees are going up next month.",
                options: [
                    { text: "That's extortion!", type: "aggressive", analysis: "ğŸš« <b>Emotional</b><br>æƒ…ç·’åŒ–ç™¼è¨€ç„¡åŠ©æ–¼è«‡åˆ¤ã€‚" },
                    { text: "A 50% hike is unexpected and exceeds our budget. We might have to migrate to a competitor. Can we lock in the old rate for 1 more year?", type: "pragmatic", analysis: "âœ… <b>Leverage</b><br>æå‡ºç±Œç¢¼ (Migrate to competitor) ä¸¦æå‡ºæŠ˜è¡·æ–¹æ¡ˆ (Lock in rate)ã€‚" },
                    { text: "Okay, send the invoice.", type: "passive", analysis: "âš ï¸ <b>Easy Target</b><br>ä¸æ®ºåƒ¹å°±æ˜¯è¢«ç•¶è‚¥ç¾Šã€‚" }
                ]
            },
            {
                difficulty: 3, npc: "Stakeholder", context: "Conflict: Sales and Ops have conflicting requests.",
                text: "Sales wants X, Ops wants Y. We can't do both.",
                options: [
                    { text: "Make up your minds!", type: "aggressive", analysis: "ğŸš« <b>Rude</b><br>é›–ç„¶ä»–å€‘å¾ˆç…©ï¼Œä½†ä½ ä¸èƒ½é€™æ¨£å¼ã€‚" },
                    { text: "I need you two to align on the business priority. I will pause development until a unified requirement is decided.", type: "pragmatic", analysis: "âœ… <b>Escalation</b><br>å¼·è¿«åˆ©ç›Šé—œä¿‚äººå…ˆé”æˆå…±è­˜ï¼Œé¿å…é–‹ç™¼è³‡æºæµªè²»ã€‚" },
                    { text: "I'll try to do a bit of both.", type: "passive", analysis: "âš ï¸ <b>Frankenstein</b><br>åšå‡ºä¸€å€‹å››ä¸åƒçš„ç”¢å“ï¼Œå…©é‚Šéƒ½ä¸è¨å¥½ã€‚" }
                ]
            },
            {
                difficulty: 3, npc: "User_Base", context: "Public Outrage: Users hate the new UI redesign.",
                text: "(Social media exploding with negative comments)",
                options: [
                    { text: "They just hate change. Ignore them.", type: "aggressive", analysis: "ğŸš« <b>Tone Deaf</b><br>ç„¡è¦–ç”¨æˆ¶è²éŸ³æ˜¯ç”¢å“æ­»äº¡çš„å‰å¥ã€‚" },
                    { text: "We hear you. We are analyzing the feedback and will roll out a patch to address the contrast issues this week.", type: "pragmatic", analysis: "âœ… <b>Public Relations</b><br>æ‰¿èª (Hear you) + è¡Œå‹• (Patch) + æ™‚ç¨‹ (This week)ã€‚" },
                    { text: "Sorry! We will revert everything immediately!", type: "passive", analysis: "âš ï¸ <b>Panic</b><br>ç«‹å³å›æ»¾å¯èƒ½ä¸æ˜¯æ­£è§£ï¼Œæ‡‰è©²å…ˆåˆ†ææ•¸æ“šã€‚" }
                ]
            }
        ];

        // ==========================================
        //  GAME LOGIC
        // ==========================================
        let gamePath = [];
        let currentStep = 0;
        let score = 0;

        function initGame() {
            gamePath = generatePath();
            currentStep = 0;
            score = 0;
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('game-header').style.display = 'block';
            document.getElementById('scene-area').style.display = 'flex';
            updateUI();
            loadScenario();
        }

        function generatePath() {
            // Pick 10 questions: 3 Easy, 4 Medium, 3 Hard from the pool of 30
            const easy = scenarioPool.filter(s => s.difficulty === 1);
            const med = scenarioPool.filter(s => s.difficulty === 2);
            const hard = scenarioPool.filter(s => s.difficulty === 3);

            const pick = (arr, n) => {
                const shuffled = arr.sort(() => 0.5 - Math.random());
                return shuffled.slice(0, n);
            };

            return [...pick(easy, 3), ...pick(med, 4), ...pick(hard, 3)];
        }

        function updateUI() {
            document.getElementById('score-display').textContent = score;
            const progress = ((currentStep) / 10) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
        }

        function loadScenario() {
            if (currentStep >= 10) {
                endGame();
                return;
            }

            const data = gamePath[currentStep];
            const badgeArea = document.getElementById('badge-area');
            let diffClass = data.difficulty === 1 ? 'diff-easy' : (data.difficulty === 2 ? 'diff-med' : 'diff-hard');
            let diffText = data.difficulty === 1 ? 'LV 1-3: JUNIOR' : (data.difficulty === 2 ? 'LV 4-7: SENIOR' : 'LV 8-10: CTO/LEAD');
            badgeArea.innerHTML = `<span class="difficulty-badge ${diffClass}">${diffText}</span> <span style="font-size:0.75rem; color:#666; margin-left:10px;">Scenario ${currentStep + 1}/10</span>`;

            document.getElementById('scene-context').textContent = `// ${data.context}`;
            document.getElementById('npc-name').textContent = data.npc;
            document.getElementById('npc-text').textContent = data.text;
            
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            
            const shuffledOptions = [...data.options].sort(() => 0.5 - Math.random());

            shuffledOptions.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                const letters = ['A', 'B', 'C'];
                btn.innerHTML = `<span class="option-tag">${letters[idx]}</span> ${opt.text}`;
                btn.onclick = () => handleChoice(opt);
                container.appendChild(btn);
            });
        }

        function handleChoice(option) {
            let title = "";
            let titleClass = "";
            
            if (option.type === 'pragmatic') {
                score += 100;
                title = "COMPILE SUCCESS";
                titleClass = "success";
            } else if (option.type === 'passive') {
                score += 40; 
                title = "WARNING: Passive Voice";
                titleClass = "warning";
            } else {
                score += 0;
                title = "RUNTIME ERROR: Pragmatic Failure";
                titleClass = "error";
            }
            
            showFeedback(title, titleClass, option.analysis);
        }

        function showFeedback(title, cssClass, analysis) {
            const overlay = document.getElementById('feedback-overlay');
            const header = document.getElementById('feedback-header');
            const content = document.getElementById('feedback-content');
            
            header.textContent = title;
            header.className = `feedback-header ${cssClass}`;
            content.innerHTML = analysis;
            overlay.style.display = 'flex';
        }

        function nextLevel() {
            document.getElementById('feedback-overlay').style.display = 'none';
            currentStep++;
            updateUI();
            loadScenario();
        }

        function endGame() {
            document.getElementById('scene-area').style.display = 'none';
            document.getElementById('game-header').style.display = 'none';
            document.getElementById('end-screen').style.display = 'flex';
            
            const finalScore = document.getElementById('final-score');
            finalScore.textContent = score;
            
            const msg = document.getElementById('final-msg');
            if (score >= 900) {
                msg.innerHTML = "ğŸ† <b>CTO Level!</b><br>æŠ€è¡“èˆ‡æºé€šçš„å®Œç¾çµåˆã€‚è«‹ç›´æ¥å»è·Ÿè€é—†è«‡åŠ è–ªã€‚";
                finalScore.style.color = "#3fb950";
            } else if (score >= 700) {
                msg.innerHTML = "ğŸ¥ˆ <b>Senior Engineer</b><br>å¾ˆç©©ï¼Œä½†é¢å°é«˜å£“æ”¿æ²»èˆ‡å±æ©Ÿæ™‚é‚„å¯ä»¥æ›´åœ“æ»‘ä¸€é»ã€‚";
                finalScore.style.color = "#d29922";
            } else {
                msg.innerHTML = "ğŸ’€ <b>Refactor Needed</b><br>ä½ çš„æºé€šé¢¨æ ¼å¯èƒ½æœƒå°è‡´å°ˆæ¡ˆå¤±æ•—ã€‚å»ºè­°å¤šç©å¹¾æ¬¡ç·´ç¿’èªæ°£ã€‚";
                finalScore.style.color = "#f85149";
            }
        }
    </script>
</body>
</html>